<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#fff0f6" />
  <title>Our Song</title>
  <link rel="stylesheet" href="style.css" />
</head>
  <script>
  (function () {
    const audio = document.getElementById("ourAudio");
    if (!audio) return;

    // Restore time + play state
    const savedTime = Number(localStorage.getItem("ourSong_time") || "0");
    const shouldPlay = localStorage.getItem("ourSong_playing") === "1";

    // Safari can be picky about setting currentTime before metadata loads
    audio.addEventListener("loadedmetadata", () => {
      if (!Number.isNaN(savedTime) && savedTime > 0 && savedTime < audio.duration) {
        audio.currentTime = savedTime;
      }
      if (shouldPlay) {
        audio.play().catch(() => {
          // Autoplay may be blocked until user interacts
        });
      }
    });

    // Save time periodically
    const saveTime = () => localStorage.setItem("ourSong_time", String(audio.currentTime || 0));
    audio.addEventListener("timeupdate", saveTime);
    window.addEventListener("beforeunload", saveTime);

    // Save play/pause state
    audio.addEventListener("play", () => localStorage.setItem("ourSong_playing", "1"));
    audio.addEventListener("pause", () => localStorage.setItem("ourSong_playing", "0"));
  })();
</script>

<body>
  <div id="musicBar" style="position:sticky;top:0;z-index:10000;padding:10px 0;">
  <div class="card" style="padding:14px 16px;">
    <div class="center">
      <h2 style="font-size:28px;margin:0 0 6px;">Our song ğŸ¶</h2>
      <audio id="ourAudio" controls preload="auto" style="width:min(520px,100%);">
        <source src="audio/oursong.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
      <p class="small" style="margin-top:8px;">Press play once â€” itâ€™ll keep going as you click Next ğŸ’—</p>
    </div>
  </div>
</div>

  <div class="hearts" aria-hidden="true">
  <span>ğŸ’—</span><span>ğŸ’–</span><span>ğŸ’˜</span><span>ğŸ’</span><span>ğŸ’•</span>
  <span>ğŸ’—</span><span>ğŸ’–</span><span>ğŸ’˜</span><span>ğŸ’</span><span>ğŸ’•</span>
  <span>ğŸ’—</span><span>ğŸ’–</span><span>ğŸ’˜</span><span>ğŸ’</span><span>ğŸ’•</span>
  </div>

  <main class="card center">
    <h1>Our song ğŸ¶</h1>
    <p>Click this when you want to smile:</p>

    <!-- Replace the link below with your Spotify song link -->
    <div class="buttons">
      <a class="btn btn-primary" href="https://open.spotify.com/track/30rU9CBF5cwiexNHJffkLS?si=qnZ-r1trQEiHgBnbcaTg1g" target="_blank" rel="noreferrer">
        Open on Spotify ğŸ’š
      </a>
    </div>

    <div class="nav">
      <a class="btn btn-soft" href="poem.html">Back</a>
      <a class="btn btn-primary" href="note.html">Next âœ</a>
    </div>
  </main>
</body>
</html>
